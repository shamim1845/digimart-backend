"use strict";(self.webpackChunkdigimart_frontend=self.webpackChunkdigimart_frontend||[]).push([[207],{1207:function(n,e,t){t.r(e),t.d(e,{default:function(){return ln}});var r,i,o,a=t(168),s=t(2791),d=t(7691),p=t(8802),l=t(8087),u=t(184),c=function(){return(0,u.jsx)(m,{children:(0,u.jsx)(l.Z,{title:"Order Summary"})})},m=d.ZP.div(r||(r=(0,a.Z)(["\n  max-width: 35rem;\n  margin-top: 3.3rem;\n\n  @media screen and (max-width: 768px) {\n    margin: 0 auto;\n  }\n"]))),x=t(9439),f=t(1413),h=t(242),g=t(4459),v=t(4054),b=t(7541),y=t(3229),Z=t(2265),j=t(7569),w=t(3724),S=t(9298),k=t(4569),P=t.n(k),C=t(5705),_=t(2797),I=t(1197),z=t(9814),N=t(7352),q=t(4489),A=function(n){var e=n.setIsShipping,t=(0,s.useState)(""),r=(0,x.Z)(t,2),i=r[0],o=r[1],a=(0,s.useState)(""),d=(0,x.Z)(a,2),p=d[0],l=d[1],c=(0,s.useState)(!1),m=(0,x.Z)(c,2),k=m[0],A=m[1],E=(0,s.useState)({address:"",phoneNo:"",postCode:"",country:"",state:"",city:""}),T=(0,x.Z)(E,2),O=T[0],Y=T[1];return(0,s.useEffect)((function(){P().get("/api/v1/shippinginfo").then((function(n){var e,t;if(200===n.status&&null!==n&&void 0!==n&&null!==(e=n.data)&&void 0!==e&&null!==(t=e.shippingInfo)&&void 0!==t&&t.country){var r,i,a,s,d,p,u,c,m,x=null===(r=h.Z.getAllCountries())||void 0===r?void 0:r.find((function(e){var t,r;return e.name===(null===n||void 0===n||null===(t=n.data)||void 0===t||null===(r=t.shippingInfo)||void 0===r?void 0:r.country)})),f=null===(i=g.ZP.getStatesOfCountry(x.isoCode))||void 0===i?void 0:i.find((function(e){var t,r;return e.name===(null===n||void 0===n||null===(t=n.data)||void 0===t||null===(r=t.shippingInfo)||void 0===r?void 0:r.state)})),b=null===(a=v.Z.getCitiesOfState(x.isoCode,f.isoCode))||void 0===a?void 0:a.find((function(e){var t,r;return e.name===(null===n||void 0===n||null===(t=n.data)||void 0===t||null===(r=t.shippingInfo)||void 0===r?void 0:r.city)}));o(x.isoCode),l(f.isoCode),Y({address:null===n||void 0===n||null===(s=n.data)||void 0===s||null===(d=s.shippingInfo)||void 0===d?void 0:d.address,phoneNo:null===n||void 0===n||null===(p=n.data)||void 0===p||null===(u=p.shippingInfo)||void 0===u?void 0:u.phoneNo,postCode:null===n||void 0===n||null===(c=n.data)||void 0===c||null===(m=c.shippingInfo)||void 0===m?void 0:m.postCode,country:x.isoCode,state:f.isoCode,city:b.name})}}))}),[]),(0,u.jsx)(B,{children:(0,u.jsx)(C.J9,{initialValues:O,validationSchema:_.Ry({address:_.Z_().required("Address is required."),phoneNo:_.Z_().required("Phone number is required."),postCode:_.Rx().required("Zip code is required."),country:_.Z_().required("Country is required."),state:_.Z_().required("State is required."),city:_.Z_().required("City is required.")}),validate:function(n){n.country&&o(n.country),n.state&&l(n.state),A(!1),e(!1)},onSubmit:function(n,t){t.resetForm;var r=(0,f.Z)((0,f.Z)({},n),{},{country:h.Z.getCountryByCode(n.country).name,state:g.ZP.getStateByCodeAndCountry(n.state,n.country).name});P().post("/api/v1/shippinginfo/add",r).then((function(n){var t;N.Am.success(null===n||void 0===n||null===(t=n.data)||void 0===t?void 0:t.message),A(!0),e(!0)})).catch((function(n){N.Am.error(null===n||void 0===n?void 0:n.message)}))},enableReinitialize:!0,children:(0,u.jsxs)(C.l0,{children:[(0,u.jsxs)("div",{className:"input_group",children:[(0,u.jsx)(b.Z,{fontSize:"large",style:{marginBottom:"2rem"}}),(0,u.jsx)(I.Z,{style:{width:"100%"},type:"text",name:"address",placeholder:"Enter your shipping address"})]}),(0,u.jsxs)("div",{className:"input_group",children:[(0,u.jsx)(y.Z,{fontSize:"large",style:{marginBottom:"2rem"}}),(0,u.jsx)(I.Z,{type:"phone",name:"phoneNo",placeholder:"Enter your phone number"})]}),(0,u.jsxs)("div",{className:"input_group",children:[(0,u.jsx)(Z.Z,{fontSize:"large",style:{marginBottom:"2rem"}}),(0,u.jsx)(I.Z,{type:"number",name:"postCode",placeholder:"Enter your zip code"})]}),(0,u.jsxs)("div",{className:"input_group",children:[(0,u.jsx)(j.Z,{fontSize:"large",style:{marginBottom:"2rem"}}),(0,u.jsxs)(z.Z,{name:"country",children:[(0,u.jsx)("option",{hidden:!0,children:"Select country"}),h.Z&&h.Z.getAllCountries().map((function(n){return(0,u.jsx)("option",{value:n.isoCode,children:n.name},n.isoCode)}))]})]}),i&&(0,u.jsxs)("div",{className:"input_group",children:[(0,u.jsx)(w.Z,{fontSize:"large",style:{marginBottom:"2rem"}}),(0,u.jsxs)(z.Z,{name:"state",children:[(0,u.jsx)("option",{hidden:!0,children:"Select state"}),g.ZP&&g.ZP.getStatesOfCountry(i).map((function(n){return(0,u.jsx)("option",{value:n.isoCode,children:n.name},n.isoCode)}))]})]}),p&&(0,u.jsxs)("div",{className:"input_group",children:[(0,u.jsx)(S.Z,{fontSize:"large",style:{marginBottom:"2rem"}}),(0,u.jsxs)(z.Z,{name:"city",children:[(0,u.jsx)("option",{hidden:!0,children:"Select city"}),v.Z&&v.Z.getCitiesOfState(i,p).map((function(n){return(0,u.jsx)("option",{value:n.name,children:n.name},n.name)}))]})]}),(0,u.jsx)(q.Z,{type:"submit",disabled:k,variant:"contained",children:"Save and continue"})]})})})},B=d.ZP.div(i||(i=(0,a.Z)(["\n  width: 100%;\n  box-shadow: var(--shadow-3);\n  border-radius: 0.5rem;\n  padding: 2rem;\n  z-index: 100;\n\n  .input_group {\n    width: 100%;\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n  }\n"]))),E=t(3473),T=t(5764),O=t(4165),Y=t(5861),F=t(8661),R=t(5928),L=t(7689),U=function(n){var e=n.setIsLoading,t=(0,s.useState)(null),r=(0,x.Z)(t,2),i=r[0],o=r[1],a=(0,L.s0)(),d=(0,F.OS)(),p=(0,x.Z)(d,1)[0];(0,s.useEffect)((function(){P().get("/api/v1/shippinginfo").then((function(n){var e;o(null===n||void 0===n||null===(e=n.data)||void 0===e?void 0:e.shippingInfo)}))}),[]);var l=(0,F._0)().data,u=null===l||void 0===l?void 0:l.carts,c=(0,R.Z)(),m=c.productPrice,f=c.shippingCost,h=c.tax,g=c.total;return{createNewOrder:function(n){var t=n.paymentProvider,r=n.paymentId,o=n.paymentStatus,s=[];u.map((function(n){return s.push({productId:n.product._id,name:n.product.name,price:n.product.price,quantity:n.quantity,image:n.product.images[0].url}),null}));var d={shippingInfo:i,orderItems:s,paymentInfo:{id:r,provider:t,status:o,currency:"USD",itemsPrice:m,taxPrice:h,shippingPrice:f,totalPrice:g}};P().post("/api/v1/order/new",d).then((function(n){var e;201===n.status&&(N.Am.success((null===(e=n.data)||void 0===e?void 0:e.message)||"Your order has been Successfully created."),setTimeout((function(){a("/order/sucess"),p()}),3e3))})).catch((function(n){N.Am.error((null===n||void 0===n?void 0:n.message)||"Your order have not created."),console.error(n)})).finally((function(){e(!1)}))}}};function D(n){n.clientSecret;var e=(0,T.useStripe)(),t=(0,T.useElements)(),r=(0,s.useState)(null),i=(0,x.Z)(r,2),o=i[0],a=i[1],d=(0,s.useState)(!1),p=(0,x.Z)(d,2),l=p[0],c=p[1],m=U({setIsLoading:c}).createNewOrder,f=function(){var n=(0,Y.Z)((0,O.Z)().mark((function n(r){var i,o,s;return(0,O.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r.preventDefault(),e&&t){n.next=3;break}return n.abrupt("return");case 3:return c(!0),n.next=6,e.confirmPayment({elements:t,confirmParams:{},redirect:"if_required"});case 6:if(i=n.sent,o=i.error,s=i.paymentIntent,o&&("card_error"===o.type||"validation_error"===o.type?a(o.message):a("An unexpected error occurred.")),!s){n.next=22;break}n.t0=s.status,n.next="succeeded"===n.t0?14:"processing"===n.t0?16:"requires_payment_method"===n.t0?18:20;break;case 14:return a("Payment succeeded!"),n.abrupt("break",22);case 16:return a("Your payment is processing."),n.abrupt("break",22);case 18:return a("Your payment was not successfull, please try again."),n.abrupt("break",22);case 20:return a("Something went wrong."),n.abrupt("break",22);case 22:!o&&s&&"succeeded"===s.status&&m({paymentProvider:"stripe",paymentId:s.id,paymentStatus:s.status});case 23:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return(0,u.jsx)(G,{children:(0,u.jsxs)("form",{id:"payment-form",onSubmit:f,children:[(0,u.jsx)(T.PaymentElement,{id:"payment-element",options:{layout:"tabs"}}),(0,u.jsx)("button",{disabled:l||!e||!t,id:"submit",children:(0,u.jsx)("span",{id:"button-text",children:l?(0,u.jsx)("div",{className:"spinner",id:"spinner"}):"Pay Now"})}),o&&(0,u.jsx)("div",{id:"payment-message",children:o})]})})}var J,$,H,K,M,V,W,G=d.ZP.div(o||(o=(0,a.Z)(['\n  form {\n    width: 30vw;\n    min-width: 500px;\n    align-self: center;\n    box-shadow: var(--shadow-3);\n    border-radius: 7px;\n    padding: 40px;\n\n    #payment-element {\n      margin-bottom: 24px;\n    }\n    button {\n      background: tomato;\n      font-family: Arial, sans-serif;\n      color: #ffffff;\n      border-radius: 4px;\n      border: 0;\n      padding: 12px 16px;\n      font-size: 16px;\n      font-weight: 600;\n      cursor: pointer;\n      display: block;\n      transition: all 0.2s ease;\n      box-shadow: 0px 4px 5.5px 0px rgba(0, 0, 0, 0.07);\n      width: 100%;\n\n      &:hover {\n        filter: contrast(115%);\n      }\n\n      &:disabled {\n        opacity: 0.5;\n        cursor: default;\n      }\n\n      .spinner,\n      .spinner:before,\n      .spinner:after {\n        border-radius: 50%;\n      }\n\n      .spinner {\n        color: #ffffff;\n        font-size: 22px;\n        text-indent: -99999px;\n        margin: 0px auto;\n        position: relative;\n        width: 20px;\n        height: 20px;\n        box-shadow: inset 0 0 0 2px;\n        -webkit-transform: translateZ(0);\n        -ms-transform: translateZ(0);\n        transform: translateZ(0);\n      }\n\n      .spinner:before,\n      .spinner:after {\n        position: absolute;\n        content: "";\n      }\n\n      .spinner:before {\n        width: 10.4px;\n        height: 20.4px;\n        background: tomato;\n        border-radius: 20.4px 0 0 20.4px;\n        top: -0.2px;\n        left: -0.2px;\n        -webkit-transform-origin: 10.4px 10.2px;\n        transform-origin: 10.4px 10.2px;\n        -webkit-animation: loading 2s infinite ease 1.5s;\n        animation: loading 2s infinite ease 1.5s;\n      }\n\n      .spinner:after {\n        width: 10.4px;\n        height: 10.2px;\n        background: tomato;\n        border-radius: 0 10.2px 10.2px 0;\n        top: -0.1px;\n        left: 10.2px;\n        -webkit-transform-origin: 0px 10.2px;\n        transform-origin: 0px 10.2px;\n        -webkit-animation: loading 2s infinite ease;\n        animation: loading 2s infinite ease;\n      }\n\n      @keyframes loading {\n        0% {\n          -webkit-transform: rotate(0deg);\n          transform: rotate(0deg);\n        }\n        100% {\n          -webkit-transform: rotate(360deg);\n          transform: rotate(360deg);\n        }\n      }\n    }\n\n    #payment-message {\n      color: var(--text-secondary);\n      font-size: 14px;\n      line-height: 20px;\n      padding-top: 20px;\n      text-align: center;\n    }\n  }\n\n  @media only screen and (max-width: 600px) {\n    form {\n      width: 100%;\n      min-width: initial;\n    }\n  }\n']))),Q=function(){var n=(0,s.useState)(null),e=(0,x.Z)(n,2),t=e[0],r=e[1],i=(0,s.useState)(""),o=(0,x.Z)(i,2),a=o[0],d=o[1],p=(0,R.Z)().total;(0,s.useEffect)((function(){P().get("/api/v1/stripeappikey").then((function(n){r((0,E.J)(n.data.stripeApiKey))}))}),[]),(0,s.useEffect)((function(){p&&P().post("/api/v1/create-payment-intent",{amount:100*p}).then((function(n){return n.data})).then((function(n){return d(n.client_secret)}))}),[p]);var l={clientSecret:a,appearance:{theme:"flat",variables:{fontFamily:' "Poppins", sans-serif',fontLineHeight:"1.5",borderRadius:"5px",colorBackground:"transparent",colorPrimaryText:"#262626"},rules:{".Block":{backgroundColor:"var(--colorBackground)",boxShadow:"none",padding:"12px"},".Input":{padding:"12px",border:"none",outline:"none"},".Input:disabled, .Input--invalid:disabled":{color:"lightgray"},".Tab":{padding:"10px 12px 8px 12px",border:"none"},".Tab:hover":{border:"none",outline:"none",boxShadow:"0px 1px 1px rgba(0, 0, 0, 0.03), 0px 3px 7px rgba(18, 42, 66, 0.04)"},".Tab--selected, .Tab--selected:focus, .Tab--selected:hover":{border:"none",outline:"none",backgroundColor:"pink",boxShadow:"0 0 0 1.5px var(--colorPrimaryText), 0px 1px 1px rgba(0, 0, 0, 0.03), 0px 3px 7px rgba(18, 42, 66, 0.04)"},".Label":{fontWeight:"500"}}}};return(0,u.jsx)(X,{children:t&&a&&(0,u.jsx)(T.Elements,{options:l,stripe:t,children:(0,u.jsx)(D,{clientSecret:a})})})},X=d.ZP.div(J||(J=(0,a.Z)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding-top: 2rem;\n"]))),nn=t(7848),en=t(8361),tn=t(8269),rn=function(){var n,e,t=(0,s.useState)(!1),r=(0,x.Z)(t,2),i=r[0],o=r[1],a=(0,s.useState)(""),d=(0,x.Z)(a,2),p=d[0],l=d[1],c=(0,F._0)().data;return(0,u.jsxs)(on,{children:[(0,u.jsxs)(an,{children:[(0,u.jsx)(en.Z,{variant:"h2",text:"Shipping Information",style:{marginBottom:"1rem"}}),(0,u.jsx)(A,{setIsShipping:o})]}),i&&(0,u.jsxs)(sn,{children:[(0,u.jsx)(en.Z,{variant:"h2",text:"Choose a Payment Methods",style:{marginBottom:"1rem"}}),(0,u.jsx)("div",{className:"payment_provider",children:(0,u.jsx)("img",{style:"stripe"===p?{border:"2px solid tomato"}:{},src:"./images/payment/stripe.png",alt:"Stripe",onClick:function(){l("stripe")}})}),"stripe"===p&&(0,u.jsx)(Q,{})]}),(0,u.jsxs)(dn,{children:[(0,u.jsx)(en.Z,{variant:"h2",text:"Order Review(".concat(null===c||void 0===c||null===(n=c.carts)||void 0===n?void 0:n.length,")"),style:{marginBottom:"1rem"}}),0===(null===c||void 0===c||null===(e=c.carts)||void 0===e?void 0:e.length)?(0,u.jsx)(tn.Z,{text:"Your cart is empty.",link:"/products",btnText:"Add Product",style:{height:"auto",padding:"5rem 0"}}):(0,u.jsx)(nn.Z,{cartItem:null===c||void 0===c?void 0:c.carts})]})]})},on=d.ZP.div($||($=(0,a.Z)(["\n  flex: 3;\n  max-width: 100rem;\n  display: flex;\n  flex-direction: column;\n  gap: 5rem;\n"]))),an=d.ZP.div(H||(H=(0,a.Z)(["\n  width: 100%;\n"]))),sn=d.ZP.div(K||(K=(0,a.Z)(["\n  margin-bottom: 2rem;\n  .payment_provider {\n    img {\n      width: 20rem;\n      cursor: pointer;\n      user-select: none;\n      border-radius: 5px;\n    }\n  }\n"]))),dn=d.ZP.div(M||(M=(0,a.Z)([""]))),pn=t(9993),ln=function(){var n,e,t,r=(0,F._0)(),i=r.isSuccess,o=r.data,a=r.isError,s=r.error;return(0,u.jsx)(p.Z,{children:(0,u.jsxs)(un,{children:[a&&(0,u.jsx)(u.Fragment,{children:404===s.status?(0,u.jsx)(tn.Z,{text:(null===(n=s.data)||void 0===n?void 0:n.message)||"Your cart is empty.",link:"/products",btnText:"Add Product"}):(0,u.jsx)(pn.Z,{text:null===(e=s.data)||void 0===e?void 0:e.message,style:{padding:"10rem 0",width:"100%",background:"pink",display:"flex",justifyContent:"center"}})}),i&&(0,u.jsx)(u.Fragment,{children:null!==o&&void 0!==o&&null!==(t=o.carts)&&void 0!==t&&t.length?(0,u.jsxs)(cn,{children:[(0,u.jsx)(rn,{}),(0,u.jsx)(c,{})]}):(0,u.jsx)(tn.Z,{text:"Your cart is empty.",link:"/products",btnText:"Add Product"})})]})})},un=d.ZP.div(V||(V=(0,a.Z)(["\n  width: 100%;\n  max-width: 1440px;\n  padding: 2rem 0;\n"]))),cn=d.ZP.div(W||(W=(0,a.Z)(["\n  display: flex;\n  justify-content: space-between;\n  gap: 5rem;\n  margin-bottom: 5rem;\n\n  @media screen and (max-width: 768px) {\n    flex-direction: column;\n    padding-bottom: 5rem;\n  }\n"])))},9814:function(n,e,t){var r,i=t(168),o=t(1413),a=t(9439),s=t(5987),d=t(5705),p=t(7691),l=t(3242),u=t(184),c=["label"];e.Z=function(n){var e=n.label,t=(0,s.Z)(n,c),r=(0,d.U$)(t),i=(0,a.Z)(r,2),p=i[0],x=i[1];return(0,u.jsxs)(m,{children:[(0,u.jsx)("label",{htmlFor:t.id||t.name,children:e}),(0,u.jsx)("select",(0,o.Z)((0,o.Z)({},p),t)),x.touched&&x.error&&(0,u.jsx)(l.Z,{message:x.error})]})};var m=p.ZP.div(r||(r=(0,i.Z)(["\n  width: 100%;\n  margin-bottom: 2rem;\n  label {\n    color: var(--text-secondary);\n    font-size: 1.3rem;\n  }\n  select {\n    background: #fff;\n    color: var(--text-primary);\n    width: 100%;\n    height: 4rem;\n    padding: 0 1rem;\n    margin-top: 0.5rem;\n    border: none;\n    outline: none;\n    border-radius: 2px;\n    font-size: 1.3rem;\n    box-shadow: rgba(0, 0, 0, 0.02) 0px 1px 3px 0px,\n      rgba(27, 31, 35, 0.15) 0px 0px 0px 1px;\n    &:focus {\n      box-shadow: rgba(60, 64, 67, 0.3) 0px 1px 2px 0px,\n        rgba(60, 64, 67, 0.15) 0px 2px 6px 2px;\n    }\n\n    option {\n      &:checked {\n        color: tomato;\n      }\n    }\n  }\n"])))},1197:function(n,e,t){var r,i=t(168),o=t(1413),a=t(9439),s=t(5987),d=t(5705),p=t(7691),l=t(3242),u=t(184),c=["label"];e.Z=function(n){var e=n.label,t=(0,s.Z)(n,c),r=(0,d.U$)(t),i=(0,a.Z)(r,2),p=i[0],x=i[1];return(0,u.jsxs)(m,{children:[(0,u.jsx)("label",{htmlFor:t.id||t.name,children:e}),(0,u.jsx)("input",(0,o.Z)((0,o.Z)({},p),t)),x.touched&&x.error&&(0,u.jsx)(l.Z,{message:x.error})]})};var m=p.ZP.div(r||(r=(0,i.Z)(["\n  width: 100%;\n  margin-bottom: 2rem;\n\n  label {\n    color: var(--text-secondary);\n    font-size: 1.3rem;\n  }\n  input {\n    background: #fff;\n    color: var(--text-primary);\n    width: 100%;\n    height: 4rem;\n    padding: 0 1rem;\n    margin-top: 0.5rem;\n    border: none;\n    outline: none;\n    font-size: 1.3rem;\n    border-radius: 2px;\n    box-shadow: rgba(0, 0, 0, 0.02) 0px 1px 3px 0px,\n      rgba(27, 31, 35, 0.15) 0px 0px 0px 1px;\n    &:focus {\n      box-shadow: rgba(60, 64, 67, 0.3) 0px 1px 2px 0px,\n        rgba(60, 64, 67, 0.15) 0px 2px 6px 2px;\n\n      color: #000;\n    }\n    &::placeholder {\n      font-size: 1.3rem;\n    }\n  }\n"])))},3242:function(n,e,t){var r,i=t(168),o=(t(2791),t(7691)),a=t(184);e.Z=function(n){var e=n.message;return(0,a.jsxs)(s,{className:"error",children:[(0,a.jsx)("span",{children:"i"})," ",e]})};var s=o.ZP.div(r||(r=(0,i.Z)(["\n  font-size: 1.1rem;\n  padding: 0.5rem 0;\n  span {\n    font-style: italic;\n    color: tomato;\n    margin-right: 0.3rem;\n    font-weight: 700;\n    font-size: 1.1rem;\n  }\n"])))}}]);
//# sourceMappingURL=207.9cce1922.chunk.js.map